services:
  mysql:
    # MySQL 数据库镜像版本
    image: mysql:8.0
    # 容器名称
    container_name: mysql
    # 重启策略：除非手动停止，否则总是重启
    restart: unless-stopped
    # 环境变量配置
    environment:
      # MySQL root 用户密码
      MYSQL_ROOT_PASSWORD: rootpassword
      # 初始创建的数据库名称
      MYSQL_DATABASE: mydb
      # 创建普通用户
      MYSQL_USER: user
      # 普通用户密码
      MYSQL_PASSWORD: password
    # 端口映射：主机端口:容器端口
    ports:
      - "3306:3306"
    # 数据卷挂载：将容器数据目录映射到本地
    volumes:
      - ./data:/var/lib/mysql
    # 启动命令：使用传统密码认证插件（兼容旧客户端）
    command: --default-authentication-plugin=mysql_native_password
